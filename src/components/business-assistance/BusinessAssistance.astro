---
import type { CardForCasesProps } from "src/components/card-for-cases/CardForCases.astro";
import CardForCases from "src/components/card-for-cases/CardForCases.astro";
import HorizontalLineTitle from "src/components/horizontal-line-title/HorizontalLineTitle.astro";
import Modal from "src/components/card-for-cases/modal/Modal.astro";
import "src/components/business-assistance/BusinessAssistance.less";
import card1 from "src/assets/images/devops-case-1.svg";
import card2 from "src/assets/images/devops-case-2.png";
import card3 from "src/assets/images/devops-case-3.svg";

const assistances: CardForCasesProps[] = [
    {
        image: card1,
        title: "DEVOPS",
        subtitle: "КЕЙС",
        descriptions: {
            firstPart: "Корректные изменения ",
            firstHighlight:
                "в коде будут в пару кликов отражены в продукте без простоя.",
            secondPart: "Ошибки ",
            secondHighlight: "не пройдут через систему автоматических тестов.",
        },
        modalContent: `
            <h3>Подробности реализации</h3>
            <p>Мы внедрили CI/CD pipeline, который автоматически проверяет код и деплоит изменения.</p>
            <ul>
                <li>Сократили время деплоя на 70%</li>
                <li>Уменьшили количество ошибок в production на 90%</li>
            </ul>
        `,
    },
    {
        image: card2,
        title: "DEVOPS",
        subtitle: "КЕЙС",
        descriptions: {
            firstPart: "Системы ",
            firstHighlight:
                "сами балансировать нагрузку, находить неработающие элементы и обслуживать приложения.",
            secondPart: "Сервер ",
            secondHighlight:
                "не упадет от роста запросов — выдержит высокие нагрузки на Черную пятницу, IPO или промоакцию.",
        },
        modalContent: `
            <h3>Подробности реализации</h3>
            <p>Мы внедрили CI/CD pipeline, который автоматически проверяет код и деплоит изменения.</p>
            <ul>
                <li>Сократили время деплоя на 70%</li>
                <li>Уменьшили количество ошибок в production на 90%</li>
            </ul>
        `,
    },
    {
        image: card3,
        title: "DEVOPS",
        subtitle: "КЕЙС",
        descriptions: {
            firstPart: "Системы ",
            firstHighlight:
                "мониторинга с оповещениями по любым каналам и в любое время.",
            secondPart: "Прием заявок ",
            secondHighlight:
                "по инцидентам через чат-боты в Telegram и Slack будет автоматическим.",
        },
    },
];

let isModalOpen = false;
let modalContent = "";
/**
 * Компонент раздела "Как мы помогли бизнесу".
 */
---

<HorizontalLineTitle
    title="КАК МЫ ПОМОГЛИ БИЗНЕСУ"
    className="assistances"
    contentClassName="assistances-content"
>
    {
        assistances.map((assistance) => (
            <CardForCases
                image={assistance.image}
                title={assistance.title}
                subtitle={assistance.subtitle}
                descriptions={assistance.descriptions || {}}
                modalContent={assistance.modalContent}
                onClick={() => {
                    modalContent = assistance.modalContent || "";
                    isModalOpen = true;
                }}
            />
        ))
    }
</HorizontalLineTitle>

{
    isModalOpen && (
        <Modal
            isOpen={isModalOpen}
            closeModal={() => {
                isModalOpen = false;
            }}
            content={modalContent}
        />
    )
}
